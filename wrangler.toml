name = "portfolio"
main = ".svelte-kit/cloudflare/_worker.js"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# Enable workers.dev subdomain
workers_dev = true

# Custom domain route lives under the production env to avoid dev redirects

[vars]
ENVIRONMENT = "production"
PUBLIC_CLERK_PUBLISHABLE_KEY = "pk_test_cG9zaXRpdmUtd29tYmF0LTUyLmNsZXJrLmFjY291bnRzLmRldiQ"
PUBLIC_R2_BASE_URL = "https://9775094dc19ae9b19f8cc75e2f2b3e5c.r2.cloudflarestorage.com/portfolio-artifacts-22"

# Add CLERK_SECRET_KEY as a secret (use: wrangler secret put CLERK_SECRET_KEY)

[[d1_databases]]
binding = "DB"
database_name = "portfolio-db"
database_id = "4878e4eb-3391-4401-93cd-9c6f91897a14"

[[r2_buckets]]
binding = "ARTIFACTS"
bucket_name = "portfolio-artifacts-22"
preview_bucket_name = "portfolio-artifacts-22-dev"

[assets]
directory = ".svelte-kit/cloudflare"
binding = "ASSETS"

[build]
command = "bun run build"

[env.production]
route = "erhathaway.com/*"
